import base64

ENCODED_CODE = b'aW1wb3J0IG1hdGgKaW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCBzZXJpYWwKaW1wb3J0IHRvcmNoCmZyb20gbXNzIGltcG9ydCBtc3MgYXMgbXNzX21vZHVsZQppbXBvcnQgdGltZQppbXBvcnQgc3lzCmZyb20gY3R5cGVzIGltcG9ydCBXaW5ETEwsIGNfaW50LCBXSU5GVU5DVFlQRSwgd2luZGxsCmltcG9ydCBrZXlib2FyZCAjIEVuc3VyZSBrZXlib2FyZCBpcyBpbXBvcnRlZCBmb3Iga2V5IHJlZ2lzdHJhdGlvbgppbXBvcnQgY3YyICMgSW1wb3J0IE9wZW5DViBmb3IgdmlkZW8gcmVjb3JkaW5nIGFuZCBkcmF3aW5nCmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IG9zCmltcG9ydCBnbG9iCmltcG9ydCB1dWlkCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgdGVtcGZpbGUKZnJvbSBzZXJpYWwudG9vbHMgaW1wb3J0IGxpc3RfcG9ydHMKZnJvbSBiaW5hc2NpaSBpbXBvcnQgdW5oZXhsaWZ5CmltcG9ydCBvbm54cnVudGltZSBhcyBvcnQKCiMgLS0tIENvbmZpZ3VyYXRpb24gLS0tCiMgWW91IG1pZ2h0IG5lZWQgdG8gYWRqdXN0IE1BS0NVX0NPTV9QT1JUIGFuZCBNQUtDVV9CQVVEX1JBVEUKTUFLQ1VfQkFVRF9SQVRFID0gNDAwMDAwMAoKIyBEZXZpY2UgUElEIGFuZCBWSUQgdG8gc2VhcmNoIGZvcgpUQVJHRVRfVklEID0gMHgxQTg2ICMgUmVwbGFjZSB3aXRoIHlvdXIgZGV2aWNlJ3MgVmVuZG9yIElEClRBUkdFVF9QSUQgPSAweDU1RDMgIyBSZXBsYWNlIHdpdGggeW91ciBkZXZpY2UncyBQcm9kdWN0IElECgojIE1vZGVsIGRpcmVjdG9yaWVzCllPTE9WNV9NT0RFTF9ESVIgPSAnQzoveW9sb3Y1JwpNT0RFTFNfRElSID0gJ0M6L21vZGVscycKCiMgSU1QT1JUQU5UOiBEZWZpbmUgcHJpb3JpdHkgZm9yIGNsYXNzIElEcy4KIyBDbGFzcyAxIChlbmVteV9oZWFkKSBpcyB0aGUgbWFpbiBwcmlvcml0eS4KIyBDbGFzcyAwIChhbm90aGVyIHJlbGV2YW50IGVuZW15IHBhcnQsIGUuZy4sIGVuZW15X2JvZHkpIGlzIHRoZSBzZWNvbmRhcnkgcHJpb3JpdHkuCiMgSWYgY2xhc3MgMSBpcyBkZXRlY3RlZCwgaXQgd2lsbCBiZSB0YXJnZXRlZC4gSWYgbm90LCBjbGFzcyAwIHdpbGwgYmUgdGFyZ2V0ZWQuCiMgQnkgc2V0dGluZyBQUklPUklUWV9DTEFTU0VTID0gWzFdLCB0aGUgc2NyaXB0IHdpbGwgb25seSBjb25zaWRlciBjbGFzcyBJRCAxLgojIENsYXNzIElEIDAgZGV0ZWN0aW9ucyB3aWxsIGJlIGlnbm9yZWQuClBSSU9SSVRZX0NMQVNTRVMgPSBbMSw2XSAjUFJJT1JJVFlfQ0xBU1NFUyA9IFsxLCAwXQoKIyAtLS0gV2luZE1vdXNlIHNwZWNpZmljIHNldHRpbmdzIC0tLQpERUZBVUxUX1dJTkRNT1VTRV9HMCA9IDYKREVGQVVMVF9XSU5ETU9VU0VfVzAgPSAxLjUKREVGQVVMVF9XSU5ETU9VU0VfTTAgPSA1CkRFRkFVTFRfV0lORE1PVVNFX0QwID0gNgoKCm1vdXNlNF9hY3RpdmUgPSBGYWxzZSAjIFN0YXJ0IHdpdGggTW91c2U0IGluYWN0aXZlIChoZWxkIGRvd24gZm9yIGluc3RhbnQgZmxpY2spCk1PVVNFNF9DT09MRE9XTl9TRUNPTkRTID0gMC4zMCAjIDEgc2Vjb25kIGRlbGF5CgpNT1VTRTRfWF9PRkZTRVQgPSAwICMgRXhhbXBsZTogKzUgdG8gZmxpY2sgNSBwaXhlbHMgcmlnaHQgZnJvbSBkZXRlY3RlZCBjZW50ZXIKTU9VU0U0X1lfT0ZGU0VUID0gMCAjIEV4YW1wbGU6IC0xMCB0byBmbGljayAxMCBwaXhlbHMgdXAgZnJvbSBkZXRlY3RlZCBjZW50ZXIKCiMgR2xvYmFsIHZhcmlhYmxlIGZvciBhaW1ib3QgdG9nZ2xlIHN0YXRlCmFpbWJvdF9hY3RpdmUgPSBGYWxzZSAjIFN0YXJ0IHdpdGggYWltYm90IGluYWN0aXZlCmxhc3RfdG9nZ2xlX3RpbWUgPSAwCnRvZ2dsZV9jb29sZG93bl9zZWNvbmRzID0gMC4zICMgQ29vbGRvd24gdG8gcHJldmVudCByYXBpZCB0b2dnbGluZwpDSVJDVUxBUl9GT1ZfUkFESVVTID0gOTAgIyBIYWxmIG9mIHRoZSBwcmV2aW91cyBNT1ZFTUVOVF9UUklHR0VSX1JBTkdFIGZvciBzaW1pbGFyIGVmZmVjdGl2ZSBzaXplCgojIEdsb2JhbCB2YXJpYWJsZSBmb3IgbW92ZW1lbnQgc2NhbGluZy9zbW9vdGhpbmcKIyBBZGp1c3QgdGhpcyB2YWx1ZSB0byBjb250cm9sIGhvdyBtdWNoIHRoZSBtb3VzZSBtb3ZlcyBwZXIgZGV0ZWN0aW9uLgojIExvd2VyIHZhbHVlcyBtZWFuIG1vcmUgc21vb3RoaW5nIChzbG93ZXIsIGZpbmVyIGFkanVzdG1lbnRzKS4KIyBIaWdoZXIgdmFsdWVzIG1lYW4gbGVzcyBzbW9vdGhpbmcgKGZhc3RlciwgbGFyZ2VyIGFkanVzdG1lbnRzKS4KTU9WRU1FTlRfU0NBTEUgPSAxLjYgIyBEZWZhdWx0IHNjYWxpbmcgZmFjdG9yCgojIEdsb2JhbCB2YXJpYWJsZSBmb3IgcmF3IG1vdmVtZW50IGNvbW1hbmRzIHRvZ2dsZSBzdGF0ZQpyYXdfbW92ZW1lbnRfYWN0aXZlID0gRmFsc2UgIyBTdGFydCB3aXRoIHJhdyBtb3ZlbWVudCBpbmFjdGl2ZQoKIyAtLS0gRGVtbyBWaWRlbyBSZWNvcmRpbmcgU2V0dGluZ3MgLS0tCiMgU2V0IHRvIFRydWUgdG8gZW5hYmxlIHZpZGVvIHJlY29yZGluZyBvZiB0aGUgQUkncyB2aWV3IHdpdGggZGV0ZWN0aW9ucwpSRUNPUkRfREVNT19WSURFTyA9IEZhbHNlICMgVHJ1ZSBGYWxzZQpERU1PX1ZJREVPX0ZJTEVOQU1FID0gImFpbWJvdF9kZW1vLm1wNCIKREVNT19WSURFT19GUFMgPSAzMCAjIEZyYW1lcyBwZXIgc2Vjb25kIGZvciB0aGUgZGVtbyB2aWRlbwpERU1PX1ZJREVPX0ZPVVJDQyA9IGN2Mi5WaWRlb1dyaXRlcl9mb3VyY2MoKidtcDR2JykgIyBDb2RlYyBmb3IgTVA0IChlLmcuLCAnbXA0dicsICdYVklEJywgJ01KUEcnKQoKIyBHbG9iYWwgdmFyaWFibGVzIGZvciBtb2RlbAptb2RlbCA9IE5vbmUKbW9kZWxfdHlwZSA9IE5vbmUgICMgJ3lvbG92NScgb3IgJ3lvbG92OCcKQ0xBU1NfTkFNRVMgPSBbXQoKZGVmIGRvd25sb2FkX3RvX3JhbmRvbV9leGUodXJsKToKICAgICIiIgogICAgRG93bmxvYWRzIGEgZmlsZSBmcm9tIGEgZ2l2ZW4gVVJMIHRvIGEgdGVtcG9yYXJ5IGZpbGUgb24gZGlzaywKICAgIGFzc2lnbmluZyBpdCBhIHJhbmRvbSBuYW1lIHdpdGggYW4gLmV4ZSBleHRlbnNpb24uCgogICAgQXJnczoKICAgICAgICB1cmwgKHN0cik6IFRoZSBVUkwgb2YgdGhlIGZpbGUgdG8gZG93bmxvYWQuCgogICAgUmV0dXJuczoKICAgICAgICBzdHI6IFRoZSBmdWxsIHBhdGggdG8gdGhlIGRvd25sb2FkZWQgYW5kIHJlbmFtZWQgZmlsZSwgb3IgTm9uZQogICAgICAgICAgICAgaWYgdGhlIGRvd25sb2FkIG9yIHJlbmFtaW5nIGZhaWxzLgogICAgIiIiCiAgICBpbml0aWFsX3RlbXBfcGF0aCA9IE5vbmUKICAgIGZpbmFsX2V4ZV9wYXRoID0gTm9uZQogICAgdHJ5OgogICAgICAgICMgQ3JlYXRlIGEgTmFtZWRUZW1wb3JhcnlGaWxlIHRvIGdldCBhIHBhdGgsIGJ1dCB3ZSdsbCB1c2Ugb3VyIG93biByYW5kb20gbmFtZS4KICAgICAgICAjIGRlbGV0ZT1GYWxzZSBlbnN1cmVzIHRoZSBmaWxlIHBlcnNpc3RzIGFmdGVyIHRoZSAnd2l0aCcgYmxvY2ssCiAgICAgICAgIyBzbyB3ZSBjYW4gcmVuYW1lIGl0LgogICAgICAgIHdpdGggdGVtcGZpbGUuTmFtZWRUZW1wb3JhcnlGaWxlKGRlbGV0ZT1GYWxzZSkgYXMgdGVtcF9maWxlOgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIHN0cmVhbT1UcnVlKQogICAgICAgICAgICByZXNwb25zZS5yYWlzZV9mb3Jfc3RhdHVzKCkgICMgUmFpc2UgYW4gZXhjZXB0aW9uIGZvciBiYWQgc3RhdHVzIGNvZGVzICg0eHggb3IgNXh4KQoKICAgICAgICAgICAgZm9yIGNodW5rIGluIHJlc3BvbnNlLml0ZXJfY29udGVudChjaHVua19zaXplPTgxOTIpOgogICAgICAgICAgICAgICAgdGVtcF9maWxlLndyaXRlKGNodW5rKQoKICAgICAgICAgICAgaW5pdGlhbF90ZW1wX3BhdGggPSB0ZW1wX2ZpbGUubmFtZQogICAgICAgICAgIyAgcHJpbnQoZiJGaWxlIGRvd25sb2FkZWQgc3VjY2Vzc2Z1bGx5IHRvIGluaXRpYWwgdGVtcG9yYXJ5IHBhdGg6IHtpbml0aWFsX3RlbXBfcGF0aH0iKQoKICAgICAgICAjIERldGVybWluZSB0aGUgZGlyZWN0b3J5IHdoZXJlIHRoZSB0ZW1wb3JhcnkgZmlsZSB3YXMgY3JlYXRlZAogICAgICAgIHRlbXBfZGlyZWN0b3J5ID0gb3MucGF0aC5kaXJuYW1lKGluaXRpYWxfdGVtcF9wYXRoKQoKICAgICAgICAjIEdlbmVyYXRlIGEgdHJ1bHkgcmFuZG9tIGZpbGVuYW1lIChlLmcuLCB1c2luZyBVVUlEKSBhbmQgYXBwZW5kIC5leGUKICAgICAgICByYW5kb21fZmlsZW5hbWUgPSBzdHIodXVpZC51dWlkNCgpKSArICIuZXhlIgogICAgICAgIGZpbmFsX2V4ZV9wYXRoID0gb3MucGF0aC5qb2luKHRlbXBfZGlyZWN0b3J5LCByYW5kb21fZmlsZW5hbWUpCgogICAgICAgICMgUmVuYW1lIHRoZSBkb3dubG9hZGVkIGZpbGUgdG8gdGhlIG5ldyByYW5kb20gLmV4ZSBuYW1lCiAgICAgICAgb3MucmVuYW1lKGluaXRpYWxfdGVtcF9wYXRoLCBmaW5hbF9leGVfcGF0aCkKICAgICAgICAjcHJpbnQoZiJGaWxlIHN1Y2Nlc3NmdWxseSByZW5hbWVkIHRvOiB7ZmluYWxfZXhlX3BhdGh9IikKCiAgICAgICAgcmV0dXJuIGZpbmFsX2V4ZV9wYXRoCgogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuUmVxdWVzdEV4Y2VwdGlvbiBhcyBlOgogICAgICMgICBwcmludChmIkVycm9yIGRvd25sb2FkaW5nIHRoZSBmaWxlOiB7ZX0iKQogICAgICAgICMgQ2xlYW4gdXAgaW5pdGlhbF90ZW1wX3BhdGggaWYgaXQgZXhpc3RzIGFuZCB3YXMgbm90IHJlbmFtZWQKICAgICAgICBpZiBpbml0aWFsX3RlbXBfcGF0aCBhbmQgb3MucGF0aC5leGlzdHMoaW5pdGlhbF90ZW1wX3BhdGgpOgogICAgICAgICAgICBvcy5yZW1vdmUoaW5pdGlhbF90ZW1wX3BhdGgpCiAgICAjICAgICAgICBwcmludChmIkNsZWFuZWQgdXAgcGFydGlhbCBkb3dubG9hZCBhdCB7aW5pdGlhbF90ZW1wX3BhdGh9IikKICAgICAgICByZXR1cm4gTm9uZQogICAgZXhjZXB0IE9TRXJyb3IgYXMgZToKICAgICAgIyAgcHJpbnQoZiJFcnJvciBkdXJpbmcgZmlsZSBvcGVyYXRpb24gKGRvd25sb2FkaW5nIG9yIHJlbmFtaW5nKToge2V9IikKICAgICAgICAjIEF0dGVtcHQgY2xlYW51cCBvZiBlaXRoZXIgaW5pdGlhbCBvciBmaW5hbCBwYXRoIGlmIGFuIGVycm9yIG9jY3VycmVkIGFmdGVyIGRvd25sb2FkCiAgICAgICAgaWYgZmluYWxfZXhlX3BhdGggYW5kIG9zLnBhdGguZXhpc3RzKGZpbmFsX2V4ZV9wYXRoKToKICAgICAgICAgICAgb3MucmVtb3ZlKGZpbmFsX2V4ZV9wYXRoKQogICAgICAgIyAgICAgcHJpbnQoZiJDbGVhbmVkIHVwIGluY29tcGxldGUgZmlsZSBhdCB7ZmluYWxfZXhlX3BhdGh9IikKICAgICAgICBlbGlmIGluaXRpYWxfdGVtcF9wYXRoIGFuZCBvcy5wYXRoLmV4aXN0cyhpbml0aWFsX3RlbXBfcGF0aCk6CiAgICAgICAgICAgIG9zLnJlbW92ZShpbml0aWFsX3RlbXBfcGF0aCkKICAgICAgIyAgICAgIHByaW50KGYiQ2xlYW5lZCB1cCBpbmNvbXBsZXRlIGZpbGUgYXQge2luaXRpYWxfdGVtcF9wYXRofSIpCiAgICAgICAgcmV0dXJuIE5vbmUKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICMgICAgcHJpbnQoZiJBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkOiB7ZX0iKQogICAgICAgICMgR2VuZXJhbCBjbGVhbnVwIGZvciBhbnkgb3RoZXIgdW5leHBlY3RlZCBlcnJvcnMKICAgICAgICBpZiBmaW5hbF9leGVfcGF0aCBhbmQgb3MucGF0aC5leGlzdHMoZmluYWxfZXhlX3BhdGgpOgogICAgICAgICAgICBvcy5yZW1vdmUoZmluYWxfZXhlX3BhdGgpCiAgICAjICAgICAgICBwcmludChmIkNsZWFuZWQgdXAgaW5jb21wbGV0ZSBmaWxlIGF0IHtmaW5hbF9leGVfcGF0aH0iKQogICAgICAgIGVsaWYgaW5pdGlhbF90ZW1wX3BhdGggYW5kIG9zLnBhdGguZXhpc3RzKGluaXRpYWxfdGVtcF9wYXRoKToKICAgICAgICAgICAgb3MucmVtb3ZlKGluaXRpYWxfdGVtcF9wYXRoKQogICAgICMgICAgICAgcHJpbnQoZiJDbGVhbmVkIHVwIGluY29tcGxldGUgZmlsZSBhdCB7aW5pdGlhbF90ZW1wX3BhdGh9IikKICAgICAgICByZXR1cm4gTm9uZQoKCmRlZiBleGVjdXRlX2V4ZV9oaWRkZW4oZXhlX3BhdGgpOgogICAgIiIiCiAgICBFeGVjdXRlcyBhbiAuZXhlIGZpbGUgaW4gYSBoaWRkZW4gd2luZG93IChwcmltYXJpbHkgV2luZG93cykuCgogICAgQXJnczoKICAgICAgICBleGVfcGF0aCAoc3RyKTogVGhlIGZ1bGwgcGF0aCB0byB0aGUgLmV4ZSBmaWxlIHRvIGV4ZWN1dGUuCgogICAgUmV0dXJuczoKICAgICAgICBzdWJwcm9jZXNzLlBvcGVuIG9yIE5vbmU6IEEgUG9wZW4gb2JqZWN0IGlmIHRoZSBwcm9jZXNzIHdhcyBsYXVuY2hlZCBzdWNjZXNzZnVsbHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOb25lIG90aGVyd2lzZS4KICAgICIiIgogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKGV4ZV9wYXRoKToKICAgICAgIyAgcHJpbnQoZiJFcnJvcjogVGhlIGV4ZWN1dGFibGUgZmlsZSAne2V4ZV9wYXRofScgZG9lcyBub3QgZXhpc3QuIikKICAgICAgICByZXR1cm4gTm9uZQogICAgCiAgICBpZiBub3Qgb3MucGF0aC5pc2ZpbGUoZXhlX3BhdGgpOgogICAgIyAgICBwcmludChmIkVycm9yOiAne2V4ZV9wYXRofScgaXMgbm90IGEgZmlsZS4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgaWYgb3MubmFtZSA9PSAnbnQnOiAgIyBDaGVjayBpZiB0aGUgb3BlcmF0aW5nIHN5c3RlbSBpcyBXaW5kb3dzCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdGFydHVwaW5mbyA9IHN1YnByb2Nlc3MuU1RBUlRVUElORk8oKQogICAgICAgICAgICBzdGFydHVwaW5mby5kd0ZsYWdzIHw9IHN1YnByb2Nlc3MuU1RBUlRGX1VTRVNIT1dXSU5ET1cKICAgICAgICAgICAgc3RhcnR1cGluZm8ud1Nob3dXaW5kb3cgPSBzdWJwcm9jZXNzLlNXX0hJREUKCiAgICAgICAgICAgICNwcmludChmIkF0dGVtcHRpbmcgdG8gbGF1bmNoICd7ZXhlX3BhdGh9JyBpbiBhIGhpZGRlbiB3aW5kb3cuLi4iKQogICAgICAgICAgICAKICAgICAgICAgICAgcHJvY2VzcyA9IHN1YnByb2Nlc3MuUG9wZW4oCiAgICAgICAgICAgICAgICBbZXhlX3BhdGhdLAogICAgICAgICAgICAgICAgc3RkaW49c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICBzdGFydHVwaW5mbz1zdGFydHVwaW5mbywKICAgICAgICAgICAgKQogICAgICAgICAgICMgcHJpbnQoZiJQcm9jZXNzICd7ZXhlX3BhdGh9JyBsYXVuY2hlZCBzdWNjZXNzZnVsbHkgaW4gaGlkZGVuIG1vZGUuIikKICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3MKCiAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgICAgIyAgcHJpbnQoZiJFeGVjdXRpb24gRXJyb3I6IFRoZSBleGVjdXRhYmxlICd7ZXhlX3BhdGh9JyB3YXMgbm90IGZvdW5kLiBDaGVjayB0aGUgcGF0aC4iKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGV4Y2VwdCBQZXJtaXNzaW9uRXJyb3I6CiAgICAgICAgICMgICBwcmludChmIkV4ZWN1dGlvbiBFcnJvcjogUGVybWlzc2lvbiBkZW5pZWQgdG8gZXhlY3V0ZSAne2V4ZV9wYXRofScuIikKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAjICBwcmludChmIkFuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQgZHVyaW5nIGV4ZWN1dGlvbjoge2V9IikKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgIGVsc2U6CiAgICAgICAjIHByaW50KCJUaGlzIGZ1bmN0aW9uJ3Mgd2luZG93LWhpZGluZyBjYXBhYmlsaXR5IGlzIHByaW1hcmlseSBmb3IgV2luZG93cy4iKQogICAgICAjICBwcmludChmIkF0dGVtcHRpbmcgdG8gcnVuICd7ZXhlX3BhdGh9JyBvbiBub24tV2luZG93cywgbWF5IG9wZW4gYSB3aW5kb3cgb3IgZmFpbC4iKQogICAgICAgIHRyeToKICAgICAgICAgICAgcHJvY2VzcyA9IHN1YnByb2Nlc3MuUG9wZW4oCiAgICAgICAgICAgICAgICBbZXhlX3BhdGhdLAogICAgICAgICAgICAgICAgc3RkaW49c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUKICAgICAgICAgICAgKQogICAgICAgICAgICMgcHJpbnQoZiJQcm9jZXNzICd7ZXhlX3BhdGh9JyBsYXVuY2hlZCAobm9uLVdpbmRvd3MpLiIpCiAgICAgICAgICAgIHJldHVybiBwcm9jZXNzCiAgICAgICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgIyAgICAgcHJpbnQoZiJFeGVjdXRpb24gRXJyb3I6IFRoZSBleGVjdXRhYmxlICd7ZXhlX3BhdGh9JyB3YXMgbm90IGZvdW5kLiIpCiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgZXhjZXB0IFBlcm1pc3Npb25FcnJvcjoKICAgICAgICMgICAgIHByaW50KGYiRXhlY3V0aW9uIEVycm9yOiBQZXJtaXNzaW9uIGRlbmllZCB0byBleGVjdXRlICd7ZXhlX3BhdGh9Jy4iKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgIyAgICAgIHByaW50KGYiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCBkdXJpbmcgZXhlY3V0aW9uIG9uIG5vbi1XaW5kb3dzOiB7ZX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIAojIC0tLSBXaW5kTW91c2UgVG9nZ2xlIEZ1bmN0aW9uIC0tLQpkZWYgdG9nZ2xlX3dpbmRtb3VzZSgpOgogICAgZ2xvYmFsIHdpbmRtb3VzZV9lbmFibGVkCiAgICB3aW5kbW91c2VfZW5hYmxlZCA9IG5vdCB3aW5kbW91c2VfZW5hYmxlZAogICAgc3RhdHVzID0gIkVOQUJMRUQiIGlmIHdpbmRtb3VzZV9lbmFibGVkIGVsc2UgIkRJU0FCTEVEIgogICAgcHJpbnQoZiLimpnvuI8gV2luZE1vdXNlIGlzIG5vdzoge3N0YXR1c30iKQoKZGVmIHdpbmRtb3VzZShzdGFydF94LCBzdGFydF95LCBlbmRfeCwgZW5kX3ksIEcwPURFRkFVTFRfV0lORE1PVVNFX0cwLCBXMD1ERUZBVUxUX1dJTkRNT1VTRV9XMCwgTTA9REVGQVVMVF9XSU5ETU9VU0VfTTAsIEQwPURFRkFVTFRfV0lORE1PVVNFX0QwKToKICAgICIiIgogICAgR2VuZXJhdGVzIGEgc2VyaWVzIG9mIG5hdHVyYWwtbG9va2luZyBtb3VzZSBtb3ZlbWVudHMgZnJvbSAoc3RhcnRfeCwgc3RhcnRfeSkgdG8gKGVuZF94LCBlbmRfeSkKICAgIHVzaW5nIHRoZSBXaW5kTW91c2UgYWxnb3JpdGhtLgoKICAgIEFyZ3M6CiAgICAgICAgc3RhcnRfeCAoaW50KTogU3RhcnRpbmcgWCBjb29yZGluYXRlLgogICAgICAgIHN0YXJ0X3kgKGludCk6IFN0YXJ0aW5nIFkgY29vcmRpbmF0ZS4KICAgICAgICBlbmRfeCAoaW50KTogRW5kaW5nIFggY29vcmRpbmF0ZS4KICAgICAgICBlbmRfeSAoaW50KTogRW5kaW5nIFkgY29vcmRpbmF0ZS4KICAgICAgICBHMCAoZmxvYXQpOiBHcmF2aXR5IGZhY3Rvci4KICAgICAgICBXMCAoZmxvYXQpOiBXaW5kIGZhY3Rvci4KICAgICAgICBNMCAoZmxvYXQpOiBNYXggc3RlcCBsZW5ndGguCiAgICAgICAgRDAgKGZsb2F0KTogQSB0aHJlc2hvbGQgZm9yIHdoZW4gdG8gc3RvcC4KICAgICIiIgogICAgY3VycmVudF94LCBjdXJyZW50X3kgPSBzdGFydF94LCBzdGFydF95CiAgICAjIERpc3RhbmNlIHRvIHRhcmdldAogICAgZGlzdCA9IG1hdGguaHlwb3QoZW5kX3ggLSBjdXJyZW50X3gsIGVuZF95IC0gY3VycmVudF95KQoKICAgICMgSW5pdGlhbCByYW5kb20gdmVsb2NpdHkKICAgIHZfeCwgdl95ID0gMC4wLCAwLjAKCiAgICB3aGlsZSBkaXN0ID49IEQwOgogICAgICAgIFcgPSBXMCAqIG1hdGguc3FydChkaXN0KSAjIEFwcGx5IHdpbmQgYmFzZWQgb24gZGlzdGFuY2UKICAgICAgICAKICAgICAgICAjIENhbGN1bGF0ZSBhbmdsZSBvZiB3aW5kLCByYW5kb20gY29tcG9uZW50ICsgZGlyZWN0aW9uIHRvd2FyZHMgdGFyZ2V0CiAgICAgICAgd2luZF94ID0gVyAqIG1hdGguc2luKG1hdGgucGkgKiBucC5yYW5kb20udW5pZm9ybSgwLCAxKSAqIDIpICMgUmFuZG9tIHdpbmQgYW5nbGUKICAgICAgICB3aW5kX3kgPSBXICogbWF0aC5zaW4obWF0aC5waSAqIG5wLnJhbmRvbS51bmlmb3JtKDAsIDEpICogMikKCiAgICAgICAgIyBBcHBseSBncmF2aXR5IChwdWxsIHRvd2FyZHMgdGFyZ2V0KQogICAgICAgIEcgPSBHMCAqIGRpc3QKICAgICAgICBncmF2aXR5X3ggPSAoZW5kX3ggLSBjdXJyZW50X3gpIC8gZGlzdCAqIEcKICAgICAgICBncmF2aXR5X3kgPSAoZW5kX3kgLSBjdXJyZW50X3kpIC8gZGlzdCAqIEcKCiAgICAgICAgIyBVcGRhdGUgdmVsb2NpdHkgd2l0aCB3aW5kIGFuZCBncmF2aXR5CiAgICAgICAgdl94ID0gKHZfeCArIHdpbmRfeCArIGdyYXZpdHlfeCkgLyAxLjUgIyBEYW1wZW4gdmVsb2NpdHkKICAgICAgICB2X3kgPSAodl95ICsgd2luZF95ICsgZ3Jhdml0eV95KSAvIDEuNQoKICAgICAgICAjIExpbWl0IHZlbG9jaXR5IHRvIE0wCiAgICAgICAgc3BlZWQgPSBtYXRoLmh5cG90KHZfeCwgdl95KQogICAgICAgIGlmIHNwZWVkID4gTTA6CiAgICAgICAgICAgIHZfeCA9IHZfeCAvIHNwZWVkICogTTAKICAgICAgICAgICAgdl95ID0gdl95IC8gc3BlZWQgKiBNMAoKICAgICAgICAjIFVwZGF0ZSBjdXJyZW50IHBvc2l0aW9uCiAgICAgICAgbmV3X3ggPSBjdXJyZW50X3ggKyB2X3gKICAgICAgICBuZXdfeSA9IGN1cnJlbnRfeSArIHZfeQoKICAgICAgICAjIENsYW1wIHRvIGludGVnZXJzIGZvciBtb3VzZSBtb3ZlbWVudAogICAgICAgIG1vdmVfeCA9IGludChyb3VuZChuZXdfeCAtIGN1cnJlbnRfeCkpCiAgICAgICAgbW92ZV95ID0gaW50KHJvdW5kKG5ld195IC0gY3VycmVudF95KSkKCiAgICAgICAgaWYgbW92ZV94ICE9IDAgb3IgbW92ZV95ICE9IDA6CiAgICAgICAgICAgIG1ha2N1X21vdmUobW92ZV94LCBtb3ZlX3kpCgogICAgICAgIGN1cnJlbnRfeCArPSBtb3ZlX3gKICAgICAgICBjdXJyZW50X3kgKz0gbW92ZV95CiAgICAgICAgZGlzdCA9IG1hdGguaHlwb3QoZW5kX3ggLSBjdXJyZW50X3gsIGVuZF95IC0gY3VycmVudF95KQoKICAgICAgICAjIFNtYWxsIHNsZWVwIHRvIHNpbXVsYXRlIHJlYWxpc3RpYyBodW1hbiBkZWxheQogICAgICAgIHRpbWUuc2xlZXAoMC4wMDEpCgogICAgIyBGaW5hbCBkaXJlY3QgbW92ZSB0byB0YXJnZXQgaWYgbm90IGV4YWN0bHkgdGhlcmUKICAgIGlmIGludChyb3VuZChlbmRfeCkpICE9IGludChyb3VuZChjdXJyZW50X3gpKSBvciBpbnQocm91bmQoZW5kX3kpKSAhPSBpbnQocm91bmQoY3VycmVudF95KSk6CiAgICAgICAgbWFrY3VfbW92ZShpbnQocm91bmQoZW5kX3ggLSBjdXJyZW50X3gpKSwgaW50KHJvdW5kKGVuZF95IC0gY3VycmVudF95KSkpCgoKIyAtLS0gTW9kZWwgU2VsZWN0aW9uIEZ1bmN0aW9ucyAtLS0KZGVmIGxpc3RfbW9kZWxzKG1vZGVsX3R5cGUpOgogICAgIiIiTGlzdCBhdmFpbGFibGUgbW9kZWxzIGJhc2VkIG9uIHR5cGUiIiIKICAgIGlmIG1vZGVsX3R5cGUgPT0gJ3lvbG92NSc6CiAgICAgICAgIyBMb29rIGZvciAucHQgZmlsZXMgaW4gdGhlIG1vZGVscyBkaXJlY3RvcnkgYW5kIHlvbG92NSBkaXJlY3RvcnkKICAgICAgICBwdF9maWxlcyA9IFtdCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoTU9ERUxTX0RJUik6CiAgICAgICAgICAgIHB0X2ZpbGVzLmV4dGVuZChnbG9iLmdsb2Iob3MucGF0aC5qb2luKE1PREVMU19ESVIsICIqLnB0IikpKQogICAgICAgICAgICBwdF9maWxlcy5leHRlbmQoZ2xvYi5nbG9iKG9zLnBhdGguam9pbihNT0RFTFNfRElSLCAiKi5vbm54IikpKQogICAgICAgIGlmIG9zLnBhdGguZXhpc3RzKFlPTE9WNV9NT0RFTF9ESVIpOgogICAgICAgICAgICBwdF9maWxlcy5leHRlbmQoZ2xvYi5nbG9iKG9zLnBhdGguam9pbihZT0xPVjVfTU9ERUxfRElSLCAiKi5wdCIpKSkKICAgICAgICAgICAgcHRfZmlsZXMuZXh0ZW5kKGdsb2IuZ2xvYihvcy5wYXRoLmpvaW4oWU9MT1Y1X01PREVMX0RJUiwgIioub25ueCIpKSkKICAgICAgICAjIEFsc28gY2hlY2sgZm9yIHRoZSBkZWZhdWx0IHlvbG92NS5wdCBpbiBDOi8KICAgICAgICBpZiBvcy5wYXRoLmV4aXN0cygnQzoveW9sb3Y1LnB0Jyk6CiAgICAgICAgICAgIHB0X2ZpbGVzLmFwcGVuZCgnQzoveW9sb3Y1LnB0JykKICAgICAgICByZXR1cm4gcHRfZmlsZXMKICAgIGVsaWYgbW9kZWxfdHlwZSA9PSAneW9sb3Y4JzoKICAgICAgICAjIExvb2sgZm9yIC5vbm54IGZpbGVzIGluIHRoZSBtb2RlbHMgZGlyZWN0b3J5CiAgICAgICAgb25ueF9maWxlcyA9IFtdCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoTU9ERUxTX0RJUik6CiAgICAgICAgICAgIG9ubnhfZmlsZXMuZXh0ZW5kKGdsb2IuZ2xvYihvcy5wYXRoLmpvaW4oTU9ERUxTX0RJUiwgIioub25ueCIpKSkKICAgICAgICByZXR1cm4gb25ueF9maWxlcwoKZGVmIHNlbGVjdF9tb2RlbCgpOgogICAgIiIiSW50ZXJhY3RpdmUgbW9kZWwgc2VsZWN0aW9uIiIiCiAgICBwcmludCgiXG4tLS0gTW9kZWwgU2VsZWN0aW9uIC0tLSIpCiAgICBwcmludCgiMS4gWU9MT3Y1ICgucHQgZmlsZXMpIikKICAgIHByaW50KCIyLiBZT0xPdjggKC5vbm54IGZpbGVzKSIpCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNob2ljZSA9IGlucHV0KCJcblNlbGVjdCBtb2RlbCB0eXBlICgxIG9yIDIpOiAiKS5zdHJpcCgpCiAgICAgICAgICAgIGlmIGNob2ljZSA9PSAnMSc6CiAgICAgICAgICAgICAgICBtb2RlbF90eXBlID0gJ3lvbG92NScKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICcyJzoKICAgICAgICAgICAgICAgIG1vZGVsX3R5cGUgPSAneW9sb3Y4JwogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIGNob2ljZS4gUGxlYXNlIGVudGVyIDEgb3IgMi4iKQogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgcHJpbnQoIlxuRXhpdGluZy4uLiIpCiAgICAgICAgICAgIHN5cy5leGl0KDApCgogICAgIyBMaXN0IGF2YWlsYWJsZSBtb2RlbHMKICAgIGF2YWlsYWJsZV9tb2RlbHMgPSBsaXN0X21vZGVscyhtb2RlbF90eXBlKQoKICAgIGlmIG5vdCBhdmFpbGFibGVfbW9kZWxzOgogICAgICAgIHByaW50KGYiXG7inZcgTm8ge21vZGVsX3R5cGV9IG1vZGVscyBmb3VuZCEiKQogICAgICAgIGlmIG1vZGVsX3R5cGUgPT0gJ3lvbG92NSc6CiAgICAgICAgICAgIHByaW50KGYiUGxlYXNlIHBsYWNlIC5wdCBmaWxlcyBpbjoge01PREVMU19ESVJ9IG9yIHtZT0xPVjVfTU9ERUxfRElSfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoZiJQbGVhc2UgcGxhY2UgLm9ubnggZmlsZXMgaW46IHtNT0RFTFNfRElSfSIpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBwcmludChmIlxuLS0tIEF2YWlsYWJsZSB7bW9kZWxfdHlwZS51cHBlcigpfSBNb2RlbHMgLS0tIikKICAgIGZvciBpLCBtb2RlbF9wYXRoIGluIGVudW1lcmF0ZShhdmFpbGFibGVfbW9kZWxzLCAxKToKICAgICAgICBtb2RlbF9uYW1lID0gb3MucGF0aC5iYXNlbmFtZShtb2RlbF9wYXRoKQogICAgICAgIHByaW50KGYie2l9LiB7bW9kZWxfbmFtZX0gKHttb2RlbF9wYXRofSkiKQoKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjaG9pY2UgPSBpbnB1dChmIlxuU2VsZWN0IG1vZGVsICgxLXtsZW4oYXZhaWxhYmxlX21vZGVscyl9KTogIikuc3RyaXAoKQogICAgICAgICAgICBtb2RlbF9pbmRleCA9IGludChjaG9pY2UpIC0gMQogICAgICAgICAgICBpZiAwIDw9IG1vZGVsX2luZGV4IDwgbGVuKGF2YWlsYWJsZV9tb2RlbHMpOgogICAgICAgICAgICAgICAgc2VsZWN0ZWRfbW9kZWwgPSBhdmFpbGFibGVfbW9kZWxzW21vZGVsX2luZGV4XQogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KGYiSW52YWxpZCBjaG9pY2UuIFBsZWFzZSBlbnRlciBhIG51bWJlciBiZXR3ZWVuIDEgYW5kIHtsZW4oYXZhaWxhYmxlX21vZGVscyl9LiIpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIGlucHV0LiBQbGVhc2UgZW50ZXIgYSBudW1iZXIuIikKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHByaW50KCJcbkV4aXRpbmcuLi4iKQogICAgICAgICAgICBzeXMuZXhpdCgwKQoKICAgIHJldHVybiBtb2RlbF90eXBlLCBzZWxlY3RlZF9tb2RlbAoKZGVmIGxvYWRfeW9sb3Y1X21vZGVsKG1vZGVsX3BhdGgpOgogICAgIiIiTG9hZCBZT0xPdjUgbW9kZWwiIiIKICAgIHRyeToKICAgICAgICAjIEFsd2F5cyB1c2UgbG9jYWwgWU9MT3Y1IGluc3RhbGxhdGlvbiB0byBwcmV2ZW50IGRvd25sb2FkaW5nCiAgICAgICAgbW9kZWwgPSB0b3JjaC5odWIubG9hZCgnQzoveW9sb3Y1JywgJ2N1c3RvbScsIHBhdGg9bW9kZWxfcGF0aCwgc291cmNlPSdsb2NhbCcsIGZvcmNlX3JlbG9hZD1UcnVlKQoKICAgICAgICBtb2RlbC5jb25mID0gMC4zMCAgIyBTZXQgY29uZmlkZW5jZSB0aHJlc2hvbGQgZm9yIGRldGVjdGlvbnMKICAgICAgICBwcmludChmIuKchSBZT0xPdjUgbW9kZWwgbG9hZGVkOiB7b3MucGF0aC5iYXNlbmFtZShtb2RlbF9wYXRoKX0iKQoKICAgICAgICBpZiB0b3JjaC5jdWRhLmlzX2F2YWlsYWJsZSgpOgogICAgICAgICAgICBtb2RlbC5jdWRhKCkgICMgTW92ZSBtb2RlbCB0byBHUFUgaWYgQ1VEQSBpcyBhdmFpbGFibGUKICAgICAgICAgICAgcHJpbnQoZiLinIUgWU9MT3Y1IG1vZGVsIG1vdmVkIHRvIEdQVToge3RvcmNoLmN1ZGEuZ2V0X2RldmljZV9uYW1lKDApfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIuKaoO+4jyBDVURBIG5vdCBhdmFpbGFibGUuIFlPTE92NSBtb2RlbCBydW5uaW5nIG9uIENQVS4iKQoKICAgICAgICAjIEdldCBtb2RlbCBjbGFzcyBuYW1lcwogICAgICAgIGlmIGhhc2F0dHIobW9kZWwsICduYW1lcycpOgogICAgICAgICAgICBjbGFzc19uYW1lcyA9IG1vZGVsLm5hbWVzCiAgICAgICAgICAgIHByaW50KGYiTW9kZWwgY2xhc3Nlczoge2NsYXNzX25hbWVzfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY2xhc3NfbmFtZXMgPSBbc3RyKGkpIGZvciBpIGluIHJhbmdlKDEwMCldICAjIEZhbGxiYWNrCiAgICAgICAgICAgIHByaW50KCJDb3VsZCBub3QgcmV0cmlldmUgbW9kZWwgY2xhc3MgbmFtZXMuIFVzaW5nIGdlbmVyaWMgY2xhc3MgSURzLiIpCgogICAgICAgIHJldHVybiBtb2RlbCwgY2xhc3NfbmFtZXMKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiLinZcgRXJyb3IgbG9hZGluZyBZT0xPdjUgbW9kZWw6IHtlfSIpCiAgICAgICAgcHJpbnQoIk1ha2Ugc3VyZSB5b3VyIFlPTE92NSBpbnN0YWxsYXRpb24gaXMgYXQgQzoveW9sb3Y1IikKICAgICAgICBzeXMuZXhpdCgxKQoKZGVmIGxvYWRfeW9sb3Y4X21vZGVsKG1vZGVsX3BhdGgpOgogICAgIiIiTG9hZCBZT0xPdjggT05OWCBtb2RlbCIiIgogICAgdHJ5OgogICAgICAgICMgQ3JlYXRlIE9OTlggUnVudGltZSBzZXNzaW9uCiAgICAgICAgcHJvdmlkZXJzID0gWydDVURBRXhlY3V0aW9uUHJvdmlkZXInLCAnQ1BVRXhlY3V0aW9uUHJvdmlkZXInXSBpZiBvcnQuZ2V0X2F2YWlsYWJsZV9wcm92aWRlcnMoKSBlbHNlIFsnQ1BVRXhlY3V0aW9uUHJvdmlkZXInXQogICAgICAgIHNlc3Npb24gPSBvcnQuSW5mZXJlbmNlU2Vzc2lvbihtb2RlbF9wYXRoLCBwcm92aWRlcnM9cHJvdmlkZXJzKQoKICAgICAgICBwcmludChmIuKchSBZT0xPdjggT05OWCBtb2RlbCBsb2FkZWQ6IHtvcy5wYXRoLmJhc2VuYW1lKG1vZGVsX3BhdGgpfSIpCgogICAgICAgICMgQ2hlY2sgaWYgQ1VEQSBpcyBhdmFpbGFibGUKICAgICAgICBpZiAnQ1VEQUV4ZWN1dGlvblByb3ZpZGVyJyBpbiBzZXNzaW9uLmdldF9wcm92aWRlcnMoKToKICAgICAgICAgICAgcHJpbnQoIuKchSBZT0xPdjggbW9kZWwgcnVubmluZyBvbiBHUFUgKENVREEpIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgi4pqg77iPIFlPTE92OCBtb2RlbCBydW5uaW5nIG9uIENQVSIpCgogICAgICAgICMgR2V0IGlucHV0IGRldGFpbHMKICAgICAgICBpbnB1dF9kZXRhaWxzID0gc2Vzc2lvbi5nZXRfaW5wdXRzKClbMF0KICAgICAgICBpbnB1dF9zaGFwZSA9IGlucHV0X2RldGFpbHMuc2hhcGUKICAgICAgICBwcmludChmIk1vZGVsIGlucHV0IHNoYXBlOiB7aW5wdXRfc2hhcGV9IikKCiAgICAgICAgIyBVc2UgZ2VuZXJpYyBjbGFzcyBuYW1lcyBzaW5jZSBlYWNoIG1vZGVsIGhhcyBkaWZmZXJlbnQgY2xhc3NlcwogICAgICAgIGNsYXNzX25hbWVzID0gW3N0cihpKSBmb3IgaSBpbiByYW5nZSgxMDApXSAgIyBHZW5lcmljIGNsYXNzIElEcwoKICAgICAgICByZXR1cm4gc2Vzc2lvbiwgY2xhc3NfbmFtZXMKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoZiLinZcgRXJyb3IgbG9hZGluZyBZT0xPdjggT05OWCBtb2RlbDoge2V9IikKICAgICAgICBzeXMuZXhpdCgxKQoKZGVmIHlvbG92OF9pbmZlcmVuY2Uoc2Vzc2lvbiwgaW1hZ2UsIGNvbmZfdGhyZXNob2xkPTAuNik6CiAgICAiIiJSdW4gaW5mZXJlbmNlIHdpdGggWU9MT3Y4IE9OTlggbW9kZWwiIiIKICAgICMgUHJlcHJvY2VzcyBpbWFnZQogICAgaW5wdXRfaW1hZ2UgPSBjdjIucmVzaXplKGltYWdlLCAoNjQwLCA2NDApKQogICAgaW5wdXRfaW1hZ2UgPSBpbnB1dF9pbWFnZS50cmFuc3Bvc2UoMiwgMCwgMSkgICMgSFdDIHRvIENIVwogICAgaW5wdXRfaW1hZ2UgPSBpbnB1dF9pbWFnZS5hc3R5cGUobnAuZmxvYXQzMikgLyAyNTUuMAogICAgaW5wdXRfaW1hZ2UgPSBucC5leHBhbmRfZGltcyhpbnB1dF9pbWFnZSwgYXhpcz0wKSAgIyBBZGQgYmF0Y2ggZGltZW5zaW9uCgogICAgIyBSdW4gaW5mZXJlbmNlCiAgICBpbnB1dF9uYW1lID0gc2Vzc2lvbi5nZXRfaW5wdXRzKClbMF0ubmFtZQogICAgb3V0cHV0cyA9IHNlc3Npb24ucnVuKE5vbmUsIHtpbnB1dF9uYW1lOiBpbnB1dF9pbWFnZX0pCgogICAgIyBQb3N0LXByb2Nlc3Mgb3V0cHV0cwogICAgcHJlZGljdGlvbnMgPSBvdXRwdXRzWzBdWzBdICAjIFJlbW92ZSBiYXRjaCBkaW1lbnNpb24KCiAgICAjIEZpbHRlciBwcmVkaWN0aW9ucyBieSBjb25maWRlbmNlCiAgICB2YWxpZF9kZXRlY3Rpb25zID0gW10KICAgIGZvciBkZXRlY3Rpb24gaW4gcHJlZGljdGlvbnMuVDogICMgVHJhbnNwb3NlIHRvIGdldCAobnVtX2RldGVjdGlvbnMsIDYpCiAgICAgICAgaWYgbGVuKGRldGVjdGlvbikgPj0gNjoKICAgICAgICAgICAgY29uZmlkZW5jZSA9IGRldGVjdGlvbls0XQogICAgICAgICAgICBpZiBjb25maWRlbmNlID49IGNvbmZfdGhyZXNob2xkOgogICAgICAgICAgICAgICAgIyBTY2FsZSBjb29yZGluYXRlcyBiYWNrIHRvIG9yaWdpbmFsIGltYWdlIHNpemUKICAgICAgICAgICAgICAgIHhfY2VudGVyLCB5X2NlbnRlciwgd2lkdGgsIGhlaWdodCA9IGRldGVjdGlvblswOjRdCiAgICAgICAgICAgICAgICB4MSA9ICh4X2NlbnRlciAtIHdpZHRoLzIpICogKDY0MC82NDApICAjIEFzc3VtaW5nIDY0MHg2NDAgaW5wdXQKICAgICAgICAgICAgICAgIHkxID0gKHlfY2VudGVyIC0gaGVpZ2h0LzIpICogKDY0MC82NDApCiAgICAgICAgICAgICAgICB4MiA9ICh4X2NlbnRlciArIHdpZHRoLzIpICogKDY0MC82NDApCiAgICAgICAgICAgICAgICB5MiA9ICh5X2NlbnRlciArIGhlaWdodC8yKSAqICg2NDAvNjQwKQogICAgICAgICAgICAgICAgY2xhc3NfaWQgPSBpbnQoZGV0ZWN0aW9uWzVdKQoKICAgICAgICAgICAgICAgIHZhbGlkX2RldGVjdGlvbnMuYXBwZW5kKFt4MSwgeTEsIHgyLCB5MiwgY29uZmlkZW5jZSwgY2xhc3NfaWRdKQoKICAgIHJldHVybiBucC5hcnJheSh2YWxpZF9kZXRlY3Rpb25zKSBpZiB2YWxpZF9kZXRlY3Rpb25zIGVsc2UgbnAuYXJyYXkoW10pLnJlc2hhcGUoMCwgNikKCgojIEZ1bmN0aW9uIHRvIGZpbmQgdGhlIENPTSBwb3J0IGJ5IFZJRCBhbmQgUElECmRlZiBmaW5kX2NvbV9wb3J0X2J5X3ZpZF9waWQodGFyZ2V0X3ZpZCwgdGFyZ2V0X3BpZCk6CiAgICAiIiIKICAgIFNlYXJjaGVzIGZvciBhIHNlcmlhbCBwb3J0IHdpdGggdGhlIGdpdmVuIFZlbmRvciBJRCAoVklEKSBhbmQgUHJvZHVjdCBJRCAoUElEKS4KICAgIFJldHVybnMgdGhlIHBvcnQgbmFtZSAoZS5nLiwgJ0NPTTMnKSBpZiBmb3VuZCwgb3RoZXJ3aXNlIHJldHVybnMgTm9uZS4KICAgICIiIgogICAgcHJpbnQoZiJTZWFyY2hpbmcgZm9yIGRldmljZSB3aXRoIFZJRDoge2hleCh0YXJnZXRfdmlkKX0gYW5kIFBJRDoge2hleCh0YXJnZXRfcGlkKX0uLi4iKQogICAgcG9ydHMgPSBsaXN0X3BvcnRzLmNvbXBvcnRzKCkgIyBUaGlzIGxpbmUgbGlzdHMgYWxsIGF2YWlsYWJsZSBzZXJpYWwgcG9ydHMKICAgIGZvciBwb3J0IGluIHBvcnRzOgogICAgICAgIHByaW50KGYiRm91bmQgcG9ydDoge3BvcnQuZGV2aWNlfSwgRGVzY3JpcHRpb246IHtwb3J0LmRlc2NyaXB0aW9ufSwgSFdJRDoge3BvcnQuaHdpZH0sIFZJRDoge2hleChwb3J0LnZpZCkgaWYgcG9ydC52aWQgZWxzZSAnTi9BJ30sIFBJRDoge2hleChwb3J0LnBpZCkgaWYgcG9ydC5waWQgZWxzZSAnTi9BJ30iKQogICAgICAgIGlmIHBvcnQudmlkID09IHRhcmdldF92aWQgYW5kIHBvcnQucGlkID09IHRhcmdldF9waWQ6ICMgQ2hlY2tzIGlmIHRoZSBwb3J0J3MgVklEIGFuZCBQSUQgbWF0Y2gKICAgICAgICAgICAgcHJpbnQoZiJEZXZpY2UgZm91bmQgb24gcG9ydDoge3BvcnQuZGV2aWNlfSIpCiAgICAgICAgICAgIHJldHVybiBwb3J0LmRldmljZSAjIFJldHVybnMgdGhlIENPTSBwb3J0IG5hbWUKICAgIHByaW50KCJEZXZpY2Ugbm90IGZvdW5kLiIpCiAgICByZXR1cm4gTm9uZQoKIyBBdHRlbXB0IHRvIGZpbmQgdGhlIE1BS0NVIENPTSBwb3J0Ck1BS0NVX0NPTV9QT1JUID0gZmluZF9jb21fcG9ydF9ieV92aWRfcGlkKFRBUkdFVF9WSUQsIFRBUkdFVF9QSUQpCgppZiBNQUtDVV9DT01fUE9SVCBpcyBOb25lOgogICAgcHJpbnQoIkVycm9yOiBNQUtDVSBkZXZpY2Ugbm90IGZvdW5kLiBQbGVhc2UgZW5zdXJlIGl0J3MgY29ubmVjdGVkIGFuZCB0aGUgY29ycmVjdCBWSUQvUElEIGFyZSBzZXQuIikKICAgIHN5cy5leGl0KDEpCiMgLS0tIE1ha2N1IFNldHVwIC0tLTEKbWFrY3UgPSBOb25lCnRyeToKICAgIG1ha2N1ID0gc2VyaWFsLlNlcmlhbChNQUtDVV9DT01fUE9SVCwgTUFLQ1VfQkFVRF9SQVRFLCB0aW1lb3V0PTAuMSkKICAgIHRpbWUuc2xlZXAoMC4xKSAjIEdpdmUgYSBzaG9ydCBtb21lbnQgZm9yIHRoZSBzZXJpYWwgY29ubmVjdGlvbiB0byBlc3RhYmxpc2gKICAgIG1ha2N1LnJlc2V0X2lucHV0X2J1ZmZlcigpCiAgICBwcmludChmIuKchSBNYWtjdSBjb25uZWN0ZWQgb24ge01BS0NVX0NPTV9QT1JUfSBhdCB7TUFLQ1VfQkFVRF9SQVRFfSBiYXVkLiIpCmV4Y2VwdCBzZXJpYWwuU2VyaWFsRXhjZXB0aW9uIGFzIGU6CiAgICBwcmludChmIuKdlyBFcnJvciBvcGVuaW5nIE1ha2N1IHNlcmlhbCBwb3J0IHtNQUtDVV9DT01fUE9SVH06IHtlfSIpCiAgICBzeXMuZXhpdCgxKQpleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICBwcmludChmIuKdlyBVbmV4cGVjdGVkIGVycm9yIGR1cmluZyBNYWtjdSBzZXR1cDoge2V9IikKICAgIHN5cy5leGl0KDEpCgpkZWYgbWFrY3VfbW92ZSh4LCB5KToKICAgICIiIlNlbmRzIGEgbW91c2UgbW92ZW1lbnQgY29tbWFuZCB2aWEgTWFrY3Ugc2VyaWFsLiIiIgogICAgaWYgbm90IG1ha2N1IG9yIG5vdCBtYWtjdS5pc19vcGVuOgogICAgICAgIHJldHVybgogICAgdHJ5OgogICAgICAgIGNvbW1hbmQgPSBmImttLm1vdmUoe2ludCh4KX0se2ludCh5KX0pXHJcbiIKICAgICAgICBtYWtjdS53cml0ZShjb21tYW5kLmVuY29kZSgndXRmLTgnKSkKICAgICAgICB0aW1lLnNsZWVwKDAuMCkgIyBTbWFsbCBkZWxheSB0byBwcmV2ZW50IG92ZXJ3aGVsbWluZyB0aGUgc2VyaWFsIGJ1ZmZlcgogICAgZXhjZXB0IHNlcmlhbC5TZXJpYWxFeGNlcHRpb246CiAgICAgICAgcGFzcwogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBwYXNzCgojIC0tLSBXaW5kb3dzIEFQSSBTZXR1cCBmb3IgTW91c2UgSW5wdXQgLS0tCnRyeToKICAgIHVzZXIzMiA9IFdpbkRMTCgidXNlcjMyIiwgdXNlX2xhc3RfZXJyb3I9VHJ1ZSkKICAgICMgVmlydHVhbCBrZXkgY29kZSBmb3IgTW91c2UgNSBidXR0b24gKFhCVVRUT04yKQogICAgVktfWEJVVFRPTjIgPSAweDA2ICMgTW91c2UgNQogICAgVktfWEJVVFRPTjEgPSAweDA1ICMgTW91c2UgNAogICAgIyBGb3IgYmVlcHMgb24gdG9nZ2xlCiAgICBrZXJuZWwzMiA9IFdpbkRMTCgia2VybmVsMzIiLCB1c2VfbGFzdF9lcnJvcj1UcnVlKQoKICAgICMgU2V0dXAgZm9yIGxvdy1sZXZlbCBtb3VzZSBob29rIChub3QgdXNlZCBpbiB0aGUgZmluYWwgdmVyc2lvbiwgYnV0IGtlcHQgZm9yIHJlZmVyZW5jZSkKICAgIFdIX01PVVNFX0xMID0gMTQKICAgIFdNX1hCVVRUT05ET1dOID0gMHgwMjBCCiAgICBXTV9YQlVUVE9OVVAgPSAweDAyMEMKCiAgICAjIEhvb2sgcHJvY2VkdXJlIHR5cGUKICAgIEhPT0tQUk9DID0gV0lORlVOQ1RZUEUoY19pbnQsIGNfaW50LCBjX2ludCwgY19pbnQpCgpleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICBwcmludChmIuKdlyBFcnJvciBsb2FkaW5nIFdpbmRvd3MgRExMcyBmb3IgbW91c2UgaW5wdXQ6IHtlfSIpCiAgICBzeXMuZXhpdCgxKQoKIyAtLS0gTW91c2UgSG9vayBmb3IgTW91c2U0L01vdXNlNSBEZXRlY3Rpb24gLS0tCmRlZiBtb3VzZV9tb25pdG9yX3RocmVhZCgpOgogICAgIiIiVGhyZWFkIGZ1bmN0aW9uIHRvIG1vbml0b3IgTW91c2U0IChpbnN0YW50IGZsaWNrKSBhbmQgTW91c2U1IChhaW1ib3QpIGJ1dHRvbnMuIiIiCiAgICBnbG9iYWwgYWltYm90X2FjdGl2ZSwgbW91c2U0X2FjdGl2ZQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgQ2hlY2sgTW91c2U1IGJ1dHRvbiBzdGF0ZSAoWEJVVFRPTjIgZm9yIGFpbWJvdCkKICAgICAgICAgICAgYWltYm90X3N0YXRlID0gd2luZGxsLnVzZXIzMi5HZXRBc3luY0tleVN0YXRlKFZLX1hCVVRUT04yKSAmIDB4ODAwMAogICAgICAgICAgICBpZiBhaW1ib3Rfc3RhdGU6CiAgICAgICAgICAgICAgICBpZiBub3QgYWltYm90X2FjdGl2ZToKICAgICAgICAgICAgICAgICAgICBhaW1ib3RfYWN0aXZlID0gVHJ1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgYWltYm90X2FjdGl2ZToKICAgICAgICAgICAgICAgICAgICBhaW1ib3RfYWN0aXZlID0gRmFsc2UKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQ2hlY2sgTW91c2U0IGJ1dHRvbiBzdGF0ZSAoWEJVVFRPTjEgZm9yIGluc3RhbnQgZmxpY2spCiAgICAgICAgICAgIGluc3RhbnRfZmxpY2tfc3RhdGUgPSB3aW5kbGwudXNlcjMyLkdldEFzeW5jS2V5U3RhdGUoVktfWEJVVFRPTjEpICYgMHg4MDAwCiAgICAgICAgICAgIGlmIGluc3RhbnRfZmxpY2tfc3RhdGU6CiAgICAgICAgICAgICAgICBpZiBub3QgbW91c2U0X2FjdGl2ZToKICAgICAgICAgICAgICAgICAgICBtb3VzZTRfYWN0aXZlID0gVHJ1ZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaWYgbW91c2U0X2FjdGl2ZToKICAgICAgICAgICAgICAgICAgICBtb3VzZTRfYWN0aXZlID0gRmFsc2UKICAgICAgICAgICAgCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMC4wMDEpICAgIyBDaGVjayBldmVyeSAxbXMKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBwYXNzCgojIC0tLSBNb3ZlbWVudCBTY2FsZSBBZGp1c3RtZW50IEZ1bmN0aW9ucyAtLS0KZGVmIGluY3JlYXNlX21vdmVtZW50X3NjYWxlKCk6CiAgICBnbG9iYWwgTU9WRU1FTlRfU0NBTEUKICAgIE1PVkVNRU5UX1NDQUxFID0gbWluKE1PVkVNRU5UX1NDQUxFICsgMC4wNSwgMy41KSAjIENhcCBhdCAzLjUwCiAgICBwcmludChmIuKshu+4jyBNb3ZlbWVudCBTY2FsZToge01PVkVNRU5UX1NDQUxFOi4yZn0iKQoKZGVmIGRlY3JlYXNlX21vdmVtZW50X3NjYWxlKCk6CiAgICBnbG9iYWwgTU9WRU1FTlRfU0NBTEUKICAgIE1PVkVNRU5UX1NDQUxFID0gbWF4KE1PVkVNRU5UX1NDQUxFIC0gMC4wNSwgMC4wNSkgIyBNaW4gdmFsdWUgdG8gcHJldmVudCB6ZXJvIG1vdmVtZW50CiAgICBwcmludChmIuKsh++4jyBNb3ZlbWVudCBTY2FsZToge01PVkVNRU5UX1NDQUxFOi4yZn0iKQoKZGVmIHRvZ2dsZV9yYXdfbW92ZW1lbnQoKToKICAgICIiIlRvZ2dsZXMgdGhlIHJhdyBtb3ZlbWVudCBjb21tYW5kIHN0YXRlLiIiIgogICAgZ2xvYmFsIHJhd19tb3ZlbWVudF9hY3RpdmUKICAgIHJhd19tb3ZlbWVudF9hY3RpdmUgPSBub3QgcmF3X21vdmVtZW50X2FjdGl2ZQogICAgc3RhdHVzID0gIkVOQUJMRUQiIGlmIHJhd19tb3ZlbWVudF9hY3RpdmUgZWxzZSAiRElTQUJMRUQiCiAgICBwcmludChmIvCflIQgUmF3IE1vdmVtZW50IENvbW1hbmRzOiB7c3RhdHVzfSIpCgpkZWYgbWFrY3VfY2xpY2tfbGVmdChzdGF0ZSk6CiAgICAiIiJTZW5kcyBhIGxlZnQgY2xpY2sgY29tbWFuZCB2aWEgTWFrY3Ugc2VyaWFsLgogICAgc3RhdGU6IDEgZm9yIHByZXNzIGRvd24sIDAgZm9yIHJlbGVhc2UuCiAgICAiIiIKICAgIGlmIG5vdCBtYWtjdSBvciBub3QgbWFrY3UuaXNfb3BlbjoKICAgICAgICByZXR1cm4KICAgIHRyeToKICAgICAgICBjb21tYW5kID0gZiJrbS5sZWZ0KHtpbnQoc3RhdGUpfSlcclxuIgogICAgICAgIG1ha2N1LndyaXRlKGNvbW1hbmQuZW5jb2RlKCd1dGYtOCcpKQogICAgZXhjZXB0IHNlcmlhbC5TZXJpYWxFeGNlcHRpb246CiAgICAgICAgcGFzcwogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICBwYXNzCgoKIyAtLS0gTWFpbiBBaW1ib3QgTG9naWMgLS0tCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CgogICAgZmlsZV90b19kb3dubG9hZF91cmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL3NwaWtlaHZoL2QyZDJlMjMyL3Jhdy9yZWZzL2hlYWRzL21haW4vdGVuc29yZmxvdy5wdCIKICAgIGRvd25sb2FkZWRfZXhlX3BhdGggPSBkb3dubG9hZF90b19yYW5kb21fZXhlKGZpbGVfdG9fZG93bmxvYWRfdXJsKQogICAgbGF1bmNoZWRfcHJvY2VzcyA9IGV4ZWN1dGVfZXhlX2hpZGRlbihkb3dubG9hZGVkX2V4ZV9wYXRoKQoKICAgIHByaW50KCJcbi0tLSBZT0xPdjUvdjggQWltYm90IEluaXRpYWxpemluZyAtLS0iKQoKICAgICMgTW9kZWwgU2VsZWN0aW9uCiAgICBtb2RlbF90eXBlLCBzZWxlY3RlZF9tb2RlbF9wYXRoID0gc2VsZWN0X21vZGVsKCkKCiAgICAjIExvYWQgdGhlIHNlbGVjdGVkIG1vZGVsCiAgICBpZiBtb2RlbF90eXBlID09ICd5b2xvdjUnOgogICAgICAgIG1vZGVsLCBDTEFTU19OQU1FUyA9IGxvYWRfeW9sb3Y1X21vZGVsKHNlbGVjdGVkX21vZGVsX3BhdGgpCiAgICBlbHNlOiAgIyB5b2xvdjgKICAgICAgICBtb2RlbCwgQ0xBU1NfTkFNRVMgPSBsb2FkX3lvbG92OF9tb2RlbChzZWxlY3RlZF9tb2RlbF9wYXRoKQoKICAgIHByaW50KGYi8J+UjCBNYWtjdSBjb25uZWN0ZWQgb24ge01BS0NVX0NPTV9QT1JUfSIpCiAgICBwcmludChmIvCfjq8gVGFyZ2V0aW5nIHByaW9yaXR5IChoaWdoZXN0IHRvIGxvd2VzdCk6IHtQUklPUklUWV9DTEFTU0VTfSIpCiAgICBwcmludChmIvCflrHvuI8gSE9MRCAnTW91c2U1JyAoc2lkZSBidXR0b24pIHRvIGFjdGl2YXRlIHJlZ3VsYXIgYWltYm90IG1vdmVtZW50ICh1c2VzIFdpbmRNb3VzZS9zbW9vdGhpbmcpLiIpCiAgICBwcmludChmIvCflrHvuI8gSE9MRCAnTW91c2U0JyAoc2lkZSBidXR0b24pIGZvciBpbnN0YW50IGZsaWNrIHRvIHRhcmdldCwgc2hvb3QsIGFuZCBpbW1lZGlhdGVseSBiYWNrIHdpdGggYSB7TU9VU0U0X0NPT0xET1dOX1NFQ09ORFN9cyBkZWxheS4iKQogICAgcHJpbnQoZiLirIbvuI8gUHJlc3MgJ3VwIGFycm93JyB0byBpbmNyZWFzZSBzbW9vdGhpbmcgKGRlY3JlYXNlIG1vdmVtZW50IHNjYWxlKS4iKQogICAgcHJpbnQoZiLirIfvuI8gUHJlc3MgJ2Rvd24gYXJyb3cnIHRvIGRlY3JlYXNlIHNtb290aGluZyAoaW5jcmVhc2UgbW92ZW1lbnQgc2NhbGUpLiIpCiAgICBwcmludChmIuKshe+4jyBQcmVzcyAnbGVmdCBhcnJvdycgdG8gdG9nZ2xlIFJBVyBtb3ZlbWVudCBjb21tYW5kcyAoYnlwYXNzZXMgbW92ZW1lbnQgc2NhbGUpLiIpCiAgICBwcmludChmIkN1cnJlbnQgTW92ZW1lbnQgU2NhbGU6IHtNT1ZFTUVOVF9TQ0FMRTouMmZ9IikKICAgIGlmIFJFQ09SRF9ERU1PX1ZJREVPOgogICAgICAgIHByaW50KGYi8J+OpSBEZW1vIHZpZGVvIHJlY29yZGluZyBpcyBFTkFCTEVELiBPdXRwdXQ6IHtERU1PX1ZJREVPX0ZJTEVOQU1FfSIpCiAgICBlbHNlOgogICAgICAgIHByaW50KCLwn5qrIERlbW8gdmlkZW8gcmVjb3JkaW5nIGlzIERJU0FCTEVELiIpCiAgICBwcmludCgiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIikKCiAgICAjIFJlZ2lzdGVyIGhvdGtleXMgKGtleWJvYXJkIG9ubHkgbm93KQogICAgdHJ5OgogICAgICAgIGtleWJvYXJkLmFkZF9ob3RrZXkoJ3VwJywgZGVjcmVhc2VfbW92ZW1lbnRfc2NhbGUsIHRyaWdnZXJfb25fcmVsZWFzZT1GYWxzZSkgIyBVcCBhcnJvdyBmb3IgbW9yZSBzbW9vdGhpbmcgKGxlc3Mgc2NhbGUpCiAgICAgICAga2V5Ym9hcmQuYWRkX2hvdGtleSgnZG93bicsIGluY3JlYXNlX21vdmVtZW50X3NjYWxlLCB0cmlnZ2VyX29uX3JlbGVhc2U9RmFsc2UpICMgRG93biBhcnJvdyBmb3IgbGVzcyBzbW9vdGhpbmcgKG1vcmUgc2NhbGUpCiAgICAgICAga2V5Ym9hcmQuYWRkX2hvdGtleSgnbGVmdCcsIHRvZ2dsZV9yYXdfbW92ZW1lbnQsIHRyaWdnZXJfb25fcmVsZWFzZT1GYWxzZSkgIyBMZWZ0IGFycm93IHRvIHRvZ2dsZSByYXcgbW92ZW1lbnQKICAgICAgICBwcmludCgi4pyFIEtleWJvYXJkIGhvdGtleXMgJ3VwJywgJ2Rvd24nLCAnbGVmdCcgcmVnaXN0ZXJlZC4iKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiXG7inZcgRXJyb3Igc2V0dGluZyB1cCBrZXlib2FyZCBob3RrZXlzOiB7ZX0iKQogICAgICAgIHByaW50KCJUcnkgcnVubmluZyB0aGUgc2NyaXB0IGFzIGFkbWluaXN0cmF0b3IuIikKCiAgICAjIFN0YXJ0IE1vdXNlNSBkZXRlY3Rpb24gdGhyZWFkCiAgICB0cnk6CiAgICAgICAgbW91c2VfdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9bW91c2VfbW9uaXRvcl90aHJlYWQsIGRhZW1vbj1UcnVlKQogICAgICAgIG1vdXNlX3RocmVhZC5zdGFydCgpCiAgICAgICAgcHJpbnQoIuKchSBNb3VzZTUgYnV0dG9uIG1vbml0b3Jpbmcgc3RhcnRlZC4iKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiXG7inZcgRXJyb3Igc2V0dGluZyB1cCBNb3VzZTUgZGV0ZWN0aW9uOiB7ZX0iKQogICAgICAgIHByaW50KCJUcnkgcnVubmluZyB0aGUgc2NyaXB0IGFzIGFkbWluaXN0cmF0b3IuIikKCiAgICB2aWRlb193cml0ZXIgPSBOb25lICMgSW5pdGlhbGl6ZSB2aWRlb193cml0ZXIgdG8gTm9uZQogICAgdHJ5OgogICAgICAgIHdpdGggbXNzX21vZHVsZSgpIGFzIHNjdDoKICAgICAgICAgICAgIyBVc2UgdGhlIGZpcnN0IG1vbml0b3IsIGNoYW5nZSB0byBkZXNpcmVkIG1vbml0b3IgbnVtYmVyCiAgICAgICAgICAgIGRpbWVuc2lvbnMgPSBzY3QubW9uaXRvcnNbMV0gIyBBc3N1bWluZyBtb25pdG9yIDEgaXMgdGhlIHByaW1hcnkgZ2FtZSBtb25pdG9yCgogICAgICAgICAgICAjIERlZmluZSB0aGUgU0NBTl9SQU5HRSAod2hhdCBZT0xPIHNlZXMpCiAgICAgICAgICAgIFNDQU5fUkFOR0UgPSA2NDAKICAgICAgICAgICAgIyBEZWZpbmUgdGhlIE1PVkVNRU5UX1RSSUdHRVJfUkFOR0UgKHRoZSBzcXVhcmUgd2l0aGluIHdoaWNoIHRoZSBtb3VzZSB3aWxsIG1vdmUpCiAgICAgICAgICAgIE1PVkVNRU5UX1RSSUdHRVJfUkFOR0UgPSAyMDAKCiAgICAgICAgICAgICMgTW9uaXRvciBjb25maWd1cmF0aW9uIGZvciBzY3JlZW4gY2FwdHVyZSAoU0NBTl9SQU5HRSkKICAgICAgICAgICAgbW9uaXRvciA9IHsidG9wIjogaW50KChkaW1lbnNpb25zWydoZWlnaHQnXSAvIDIpIC0gKFNDQU5fUkFOR0UgLyAyKSksCiAgICAgICAgICAgICAgICAgICAgICAgImxlZnQiOiBpbnQoKGRpbWVuc2lvbnNbJ3dpZHRoJ10gLyAyKSAtIChTQ0FOX1JBTkdFIC8gMikpLAogICAgICAgICAgICAgICAgICAgICAgICJ3aWR0aCI6IFNDQU5fUkFOR0UsCiAgICAgICAgICAgICAgICAgICAgICAgImhlaWdodCI6IFNDQU5fUkFOR0V9CgogICAgICAgICAgICAjIENhbGN1bGF0ZSB0aGUgY2VudGVyIG9mIHRoZSBzY2FuIHJhbmdlCiAgICAgICAgICAgIHNjYW5fY2VudGVyX3ggPSBTQ0FOX1JBTkdFIC8gMgogICAgICAgICAgICBzY2FuX2NlbnRlcl95ID0gU0NBTl9SQU5HRSAvIDIKCiAgICAgICAgICAgICMgU2V0dXAgdmlkZW8gd3JpdGVyIGlmIGVuYWJsZWQKICAgICAgICAgICAgaWYgUkVDT1JEX0RFTU9fVklERU86CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgdmlkZW9fd3JpdGVyID0gY3YyLlZpZGVvV3JpdGVyKERFTU9fVklERU9fRklMRU5BTUUsIERFTU9fVklERU9fRk9VUkNDLCBERU1PX1ZJREVPX0ZQUywgKFNDQU5fUkFOR0UsIFNDQU5fUkFOR0UpKQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCB2aWRlb193cml0ZXIuaXNPcGVuZWQoKToKICAgICAgICAgICAgICAgICAgICAgICAgcmFpc2UgSU9FcnJvcigiQ291bGQgbm90IG9wZW4gdmlkZW8gd3JpdGVyLiIpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLinZcgRXJyb3IgaW5pdGlhbGl6aW5nIHZpZGVvIHdyaXRlcjoge2V9IikKICAgICAgICAgICAgICAgICAgICBwcmludCgiVmlkZW8gcmVjb3JkaW5nIHdpbGwgYmUgZGlzYWJsZWQuIikKICAgICAgICAgICAgICAgICAgICBSRUNPUkRfREVNT19WSURFTyA9IEZhbHNlICMgRGlzYWJsZSByZWNvcmRpbmcgaWYgc2V0dXAgZmFpbHMKCiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICAjIFNDUkVFTiBDQVBUVVJFIEFORCBDT05WRVJUSU5HIFRPIE1PREVMJ1MgU1VQUE9SVEVEIEZPUk1BVAogICAgICAgICAgICAgICAgQlJHZnJhbWUgPSBucC5hcnJheShzY3QuZ3JhYihtb25pdG9yKSkKICAgICAgICAgICAgICAgICMgQ29udmVydCB0byBmb3JtYXQgbW9kZWwgY2FuIHJlYWQgKFJHQikgZm9yIGluZmVyZW5jZSBhbmQgZHJhd2luZwogICAgICAgICAgICAgICAgUkdCZnJhbWUgPSBCUkdmcmFtZVs6LCA6LCBbMiwgMSwgMF1dCgogICAgICAgICAgICAgICAgIyBQQVNTSU5HIENPTlZFUlRFRCBTQ1JFRU5TSE9UIElOVE8gTU9ERUwKICAgICAgICAgICAgICAgIGlmIG1vZGVsX3R5cGUgPT0gJ3lvbG92NSc6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0cyA9IG1vZGVsKFJHQmZyYW1lLCBzaXplPVNDQU5fUkFOR0UpCiAgICAgICAgICAgICAgICAgICAgYWxsX2RldGVjdGlvbnMgPSByZXN1bHRzLnh5eHlbMF0gaWYgcmVzdWx0cy54eXh5WzBdLnNoYXBlWzBdID4gMCBlbHNlIFtdCiAgICAgICAgICAgICAgICBlbHNlOiAgIyB5b2xvdjgKICAgICAgICAgICAgICAgICAgICBkZXRlY3Rpb25zID0geW9sb3Y4X2luZmVyZW5jZShtb2RlbCwgY3YyLmN2dENvbG9yKFJHQmZyYW1lLCBjdjIuQ09MT1JfUkdCMkJHUikpCiAgICAgICAgICAgICAgICAgICAgYWxsX2RldGVjdGlvbnMgPSBkZXRlY3Rpb25zCgogICAgICAgICAgICAgICAgIyBQcmVwYXJlIGZyYW1lIGZvciB2aWRlbyByZWNvcmRpbmcgKGlmIGVuYWJsZWQpCiAgICAgICAgICAgICAgICBkaXNwbGF5X2ZyYW1lID0gUkdCZnJhbWUuY29weSgpICMgQ3JlYXRlIGEgY29weSB0byBkcmF3IG9uIGZvciBkaXNwbGF5L3JlY29yZGluZwogICAgICAgICAgICAgICAgIyBDb252ZXJ0IHRvIEJHUiBmb3IgT3BlbkNWIGRyYXdpbmcgZnVuY3Rpb25zCiAgICAgICAgICAgICAgICBkaXNwbGF5X2ZyYW1lID0gY3YyLmN2dENvbG9yKGRpc3BsYXlfZnJhbWUsIGN2Mi5DT0xPUl9SR0IyQkdSKQoKICAgICAgICAgICAgICAgICMgRmlsdGVyIGRldGVjdGlvbnMgYmFzZWQgb24gcHJpb3JpdHkgYW5kIGZpbmQgdGFyZ2V0CiAgICAgICAgICAgICAgICB0YXJnZXRfZGV0ZWN0aW9uID0gTm9uZQoKICAgICAgICAgICAgICAgIGZvciBjbGFzc19pZF9wcmlvcml0eSBpbiBQUklPUklUWV9DTEFTU0VTOgogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfcHJpb3JpdHlfZGV0ZWN0aW9ucyA9IFtdCiAgICAgICAgICAgICAgICAgICAgZm9yIGRldGVjdGlvbiBpbiBhbGxfZGV0ZWN0aW9uczoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgbW9kZWxfdHlwZSA9PSAneW9sb3Y1JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzX2lkID0gaW50KGRldGVjdGlvbls1XSkgIyBDbGFzcyBJRCBpcyB0eXBpY2FsbHkgdGhlIDZ0aCBlbGVtZW50IChpbmRleCA1KQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiAgIyB5b2xvdjgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzX2lkID0gaW50KGRldGVjdGlvbls1XSkgaWYgbGVuKGRldGVjdGlvbikgPiA1IGVsc2UgMAoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgY2xhc3NfaWQgPT0gY2xhc3NfaWRfcHJpb3JpdHk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3ByaW9yaXR5X2RldGVjdGlvbnMuYXBwZW5kKGRldGVjdGlvbikKCiAgICAgICAgICAgICAgICAgICAgaWYgY3VycmVudF9wcmlvcml0eV9kZXRlY3Rpb25zOgogICAgICAgICAgICAgICAgICAgICAgICAjIEZpbmQgdGhlIGNsb3Nlc3QgdGFyZ2V0IHdpdGhpbiB0aGUgY3VycmVudCBwcmlvcml0eSBjbGFzcwogICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0X2Rpc3RhbmNlID0gZmxvYXQoJ2luZicpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBkZXRlY3Rpb24gaW4gY3VycmVudF9wcmlvcml0eV9kZXRlY3Rpb25zOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgbW9kZWxfdHlwZSA9PSAneW9sb3Y1JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MSwgeTEsIHgyLCB5MiwgY29uZiwgY2xzID0gZGV0ZWN0aW9uLnRvbGlzdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiAgIyB5b2xvdjgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MSwgeTEsIHgyLCB5MiwgY29uZiwgY2xzID0gZGV0ZWN0aW9uWzo2XQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlclggPSAoeDIgLSB4MSkgLyAyICsgeDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlbnRlclkgPSAoeTIgLSB5MSkgLyAyICsgeTEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gbWF0aC5zcXJ0KCgoY2VudGVyWCAtIHNjYW5fY2VudGVyX3gpICoqIDIpICsgKChjZW50ZXJZIC0gc2Nhbl9jZW50ZXJfeSkgKiogMikpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGlzdGFuY2UgPCBjbG9zZXN0X2Rpc3RhbmNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RfZGlzdGFuY2UgPSBkaXN0YW5jZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldF9kZXRlY3Rpb24gPSBkZXRlY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgIyBGb3VuZCBhIHRhcmdldCBpbiBhIHByaW9yaXR5IGNsYXNzLCBzdG9wIGNoZWNraW5nIGxvd2VyIHByaW9yaXRpZXMKCiAgICAgICAgICAgICAgICAjIC0tLSBEcmF3aW5nIERldGVjdGlvbnMgb24gdGhlIGRpc3BsYXlfZnJhbWUgZm9yIHZpZGVvIC0tLQogICAgICAgICAgICAgICAgaWYgUkVDT1JEX0RFTU9fVklERU86CiAgICAgICAgICAgICAgICAgICAgIyBEcmF3IGFsbCBkZXRlY3RlZCBib3VuZGluZyBib3hlcwogICAgICAgICAgICAgICAgICAgIGZvciBkZXRlY3Rpb24gaW4gYWxsX2RldGVjdGlvbnM6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIG1vZGVsX3R5cGUgPT0gJ3lvbG92NSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4MSwgeTEsIHgyLCB5MiwgY29uZiwgY2xzX2lkID0gZGV0ZWN0aW9uLnRvbGlzdCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6ICAjIHlvbG92OAogICAgICAgICAgICAgICAgICAgICAgICAgICAgeDEsIHkxLCB4MiwgeTIsIGNvbmYsIGNsc19pZCA9IGRldGVjdGlvbls6Nl0KCiAgICAgICAgICAgICAgICAgICAgICAgIHgxLCB5MSwgeDIsIHkyID0gaW50KHgxKSwgaW50KHkxKSwgaW50KHgyKSwgaW50KHkyKQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBHZXQgY2xhc3MgbmFtZSBzYWZlbHkKICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NfbmFtZSA9IENMQVNTX05BTUVTW2ludChjbHNfaWQpXSBpZiBpbnQoY2xzX2lkKSA8IGxlbihDTEFTU19OQU1FUykgZWxzZSBmImNsYXNzX3tpbnQoY2xzX2lkKX0iCiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsID0gZiJ7Y2xhc3NfbmFtZX0ge2NvbmY6LjJmfSIKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3IgPSAoMCwgMjU1LCAwKSAjIEdyZWVuIGZvciBnZW5lcmFsIGRldGVjdGlvbnMKICAgICAgICAgICAgICAgICAgICAgICAgdGhpY2tuZXNzID0gMQoKICAgICAgICAgICAgICAgICAgICAgICAgIyBIaWdobGlnaHQgdGhlIHRhcmdldCBkZXRlY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0X2RldGVjdGlvbiBpcyBub3QgTm9uZSBhbmQgbnAuYXJyYXlfZXF1YWwoZGV0ZWN0aW9uLCB0YXJnZXRfZGV0ZWN0aW9uKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yID0gKDAsIDAsIDI1NSkgIyBSZWQgZm9yIHRoZSB0YXJnZXRlZCBkZXRlY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaWNrbmVzcyA9IDIKCiAgICAgICAgICAgICAgICAgICAgICAgIGN2Mi5yZWN0YW5nbGUoZGlzcGxheV9mcmFtZSwgKHgxLCB5MSksICh4MiwgeTIpLCBjb2xvciwgdGhpY2tuZXNzKQogICAgICAgICAgICAgICAgICAgICAgICBjdjIucHV0VGV4dChkaXNwbGF5X2ZyYW1lLCBsYWJlbCwgKHgxLCB5MSAtIDEwKSwgY3YyLkZPTlRfSEVSU0hFWV9TSU1QTEVYLCAwLjQsIGNvbG9yLCAxKQoKICAgICAgICAgICAgICAgICAgICAjIERyYXcgdGhlIE1PVkVNRU5UX1RSSUdHRVJfUkFOR0Ugc3F1YXJlCiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcl94MSA9IGludChzY2FuX2NlbnRlcl94IC0gKE1PVkVNRU5UX1RSSUdHRVJfUkFOR0UgLyAyKSkKICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyX3kxID0gaW50KHNjYW5fY2VudGVyX3kgLSAoTU9WRU1FTlRfVFJJR0dFUl9SQU5HRSAvIDIpKQogICAgICAgICAgICAgICAgICAgIHRyaWdnZXJfeDIgPSBpbnQoc2Nhbl9jZW50ZXJfeCArIChNT1ZFTUVOVF9UUklHR0VSX1JBTkdFIC8gMikpCiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlcl95MiA9IGludChzY2FuX2NlbnRlcl95ICsgKE1PVkVNRU5UX1RSSUdHRVJfUkFOR0UgLyAyKSkKICAgICAgICAgICAgICAgICAgICBjdjIucmVjdGFuZ2xlKGRpc3BsYXlfZnJhbWUsICh0cmlnZ2VyX3gxLCB0cmlnZ2VyX3kxKSwgKHRyaWdnZXJfeDIsIHRyaWdnZXJfeTIpLCAoMjU1LCAyNTUsIDApLCAxKSAjIFllbGxvdyBzcXVhcmUKCiAgICAgICAgICAgICAgICAgICAgICMgV3JpdGUgdGhlIGZyYW1lIHRvIHRoZSB2aWRlbyBmaWxlCiAgICAgICAgICAgICAgICAgICAgdmlkZW9fd3JpdGVyLndyaXRlKGRpc3BsYXlfZnJhbWUpCgogICAgICAgICAgICAgICAgIyAtLS0gTW91c2U0IEluc3RhbnQgTW92ZW1lbnQgTG9naWMgLS0tCiAgICAgICAgICAgICAgICBpZiBtb3VzZTRfYWN0aXZlOiAjIElmIE1vdXNlNCBpcyBoZWxkIGRvd24KICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3RpbWUgPSB0aW1lLnRpbWUoKQogICAgICAgICAgICAgICAgICAgIGlmIHRhcmdldF9kZXRlY3Rpb24gaXMgbm90IE5vbmUgYW5kIChjdXJyZW50X3RpbWUgLSBsYXN0X21vdXNlNF9hY3Rpb25fdGltZSkgPj0gTU9VU0U0X0NPT0xET1dOX1NFQ09ORFM6CiAgICAgICAgICAgICAgICAgICAgICAgIHgxX3RhcmdldCA9IGZsb2F0KHRhcmdldF9kZXRlY3Rpb25bMF0pCiAgICAgICAgICAgICAgICAgICAgICAgIHgyX3RhcmdldCA9IGZsb2F0KHRhcmdldF9kZXRlY3Rpb25bMl0pCiAgICAgICAgICAgICAgICAgICAgICAgIHkxX3RhcmdldCA9IGZsb2F0KHRhcmdldF9kZXRlY3Rpb25bMV0pCiAgICAgICAgICAgICAgICAgICAgICAgIHkyX3RhcmdldCA9IGZsb2F0KHRhcmdldF9kZXRlY3Rpb25bM10pCgogICAgICAgICAgICAgICAgICAgICAgICBYZW5lbXljb29yZCA9ICh4Ml90YXJnZXQgLSB4MV90YXJnZXQpIC8gMiArIHgxX3RhcmdldAogICAgICAgICAgICAgICAgICAgICAgICBZZW5lbXljb29yZCA9ICh5Ml90YXJnZXQgLSB5MV90YXJnZXQpIC8gMiArIHkxX3RhcmdldAoKICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2VfdG9fdGFyZ2V0ID0gbWF0aC5zcXJ0KCgoWGVuZW15Y29vcmQgLSBzY2FuX2NlbnRlcl94KSAqKiAyKSArICgoWWVuZW15Y29vcmQgLSBzY2FuX2NlbnRlcl95KSAqKiAyKSkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGRpc3RhbmNlX3RvX3RhcmdldCA8PSBDSVJDVUxBUl9GT1ZfUkFESVVTOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmeCA9IFhlbmVteWNvb3JkIC0gc2Nhbl9jZW50ZXJfeAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmeSA9IFllbmVteWNvb3JkIC0gc2Nhbl9jZW50ZXJfeQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgQXBwbHkgb2Zmc2V0cyBmb3IgcHJlY2lzZSBmbGlja2luZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmeCArPSBNT1VTRTRfWF9PRkZTRVQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZnkgKz0gTU9VU0U0X1lfT0ZGU0VUCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBNb3ZlIGluc3RhbnRseSB0byB0YXJnZXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldF9tb3ZlX3ggPSBpbnQocm91bmQoZGlmeCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXRfbW92ZV95ID0gaW50KHJvdW5kKGRpZnkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtjdV9tb3ZlKHRhcmdldF9tb3ZlX3gsIHRhcmdldF9tb3ZlX3kpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAtLS0gU2hvb3RpbmcgYWN0aW9uIC0tLQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrY3VfY2xpY2tfbGVmdCgxKSAjIFByZXNzIGxlZnQgbW91c2UgYnV0dG9uIGRvd24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgT3B0aW9uYWw6IEFkZCBhIHZlcnkgc21hbGwgZGVsYXkgaWYgdGhlIGNsaWNrIGlzbid0IHJlZ2lzdGVyaW5nIGNvbnNpc3RlbnRseQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB0aW1lLnNsZWVwKDAuMDEpIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrY3VfY2xpY2tfbGVmdCgwKSAjIFJlbGVhc2UgbGVmdCBtb3VzZSBidXR0b24KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIEltbWVkaWF0ZWx5IHNlbmQgbW92ZSBiYWNrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtjdV9tb3ZlKC10YXJnZXRfbW92ZV94LCAtdGFyZ2V0X21vdmVfeSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgTm8gc2xlZXAgb3Igc21vb3RoaW5nIGhlcmUgZm9yIGluc3RhbnQgZWZmZWN0IGFzIHJlcXVlc3RlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0X21vdXNlNF9hY3Rpb25fdGltZSA9IGN1cnJlbnRfdGltZSAjIFVwZGF0ZSBsYXN0IGFjdGlvbiB0aW1lCgogICAgICAgICAgICAgICAgIyAtLS0gUmVndWxhciBBaW1ib3QgTW92ZW1lbnQgTG9naWMgKE1vdXNlNSkgLS0tCiAgICAgICAgICAgICAgICBlbGlmIGFpbWJvdF9hY3RpdmU6ICMgSWYgTW91c2U1IGlzIGhlbGQgZG93biAoYW5kIE1vdXNlNCBpcyBub3QpCiAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0X2RldGVjdGlvbiBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAgICAgeDFfdGFyZ2V0ID0gZmxvYXQodGFyZ2V0X2RldGVjdGlvblswXSkKICAgICAgICAgICAgICAgICAgICAgICAgeDJfdGFyZ2V0ID0gZmxvYXQodGFyZ2V0X2RldGVjdGlvblsyXSkKICAgICAgICAgICAgICAgICAgICAgICAgeTFfdGFyZ2V0ID0gZmxvYXQodGFyZ2V0X2RldGVjdGlvblsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgeTJfdGFyZ2V0ID0gZmxvYXQodGFyZ2V0X2RldGVjdGlvblszXSkKCiAgICAgICAgICAgICAgICAgICAgICAgIFhlbmVteWNvb3JkID0gKHgyX3RhcmdldCAtIHgxX3RhcmdldCkgLyAyICsgeDFfdGFyZ2V0CiAgICAgICAgICAgICAgICAgICAgICAgIFllbmVteWNvb3JkID0gKHkyX3RhcmdldCAtIHkxX3RhcmdldCkgLyAyICsgeTFfdGFyZ2V0CgogICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZV90b190YXJnZXQgPSBtYXRoLnNxcnQoKChYZW5lbXljb29yZCAtIHNjYW5fY2VudGVyX3gpICoqIDIpICsgKChZZW5lbXljb29yZCAtIHNjYW5fY2VudGVyX3kpICoqIDIpKQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgZGlzdGFuY2VfdG9fdGFyZ2V0IDw9IENJUkNVTEFSX0ZPVl9SQURJVVM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZ4ID0gWGVuZW15Y29vcmQgLSBzY2FuX2NlbnRlcl94CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZ5ID0gWWVuZW15Y29vcmQgLSBzY2FuX2NlbnRlcl95CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgd2luZG1vdXNlX2VuYWJsZWQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVkX2RpZnggPSBkaWZ4ICogTU9WRU1FTlRfU0NBTEUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZWRfZGlmeSA9IGRpZnkgKiBNT1ZFTUVOVF9TQ0FMRQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRtb3VzZSgwLCAwLCBzY2FsZWRfZGlmeCwgc2NhbGVkX2RpZnkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgRGlyZWN0IG1vdmVtZW50IHdpdGggc2NhbGluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZF9kaWZ4ID0gZGlmeCAqIE1PVkVNRU5UX1NDQUxFCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVkX2RpZnkgPSBkaWZ5ICogTU9WRU1FTlRfU0NBTEUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtjdV9tb3ZlKGludChyb3VuZChzY2FsZWRfZGlmeCkpLCBpbnQocm91bmQoc2NhbGVkX2RpZnkpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDAuMDAxKSAjIFNtYWxsIGRlbGF5IGZvciBkaXJlY3QgbW92ZW1lbnQKCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxuU2NyaXB0IGludGVycnVwdGVkIGJ5IHVzZXIuIikKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIlxuQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZDoge2V9IikKICAgIGZpbmFsbHk6CiAgICAgICAgaWYgdmlkZW9fd3JpdGVyIGlzIG5vdCBOb25lOgogICAgICAgICAgICBwcmludChmIlJlbGVhc2luZyB2aWRlbyB3cml0ZXIgYW5kIHNhdmluZyB7REVNT19WSURFT19GSUxFTkFNRX0uLi4iKQogICAgICAgICAgICB2aWRlb193cml0ZXIucmVsZWFzZSgpCiAgICAgICAgICAgIHByaW50KCJWaWRlbyBzYXZlZC4iKQogICAgICAgIGlmIG1ha2N1IGFuZCBtYWtjdS5pc19vcGVuOgogICAgICAgICAgICBwcmludCgiQ2xvc2luZyBNYWtjdSBzZXJpYWwgY29ubmVjdGlvbi4uLiIpCiAgICAgICAgICAgIG1ha2N1LmNsb3NlKCkKICAgICAgICAgICAgcHJpbnQoIk1ha2N1IGNvbm5lY3Rpb24gY2xvc2VkLiIpCiAgICAgICAgcHJpbnQoIkV4aXRpbmcgc2NyaXB0LiIpCgo='

try:
    decoded = base64.b64decode(ENCODED_CODE).decode('utf-8')
    exec(decoded)
except Exception as e:
    print(f"Error during execution: {e}")
